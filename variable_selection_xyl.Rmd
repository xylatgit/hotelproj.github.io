---
title: "variable_selection_xyl"
author: "Xiangyi Liu (xl3048)"
date: "11/30/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyr)
library(pROC)
library(purrr)
library(readr)
```


```{r data}
hotel_ml <- read.csv("./hotel_ml.csv") %>%
  select(where(is.numeric))

hotel_df <- read.csv("./data/hotel_bookings.csv",na = c("", "NA", "NULL")) %>%
  select(where(is.numeric))

```

```{r}
variable_list <- colnames(hotel_df) 
variable_list <- variable_list[-1]

compute_auc <- function(x) {
  as.numeric(auc(roc(hotel_df[["is_canceled"]][!is.na(hotel_df[[x]])], hotel_df[[x]][!is.na(hotel_df[[x]])])))
}

auc_result<-as_tibble(t(combn(variable_list, 1)), 
          .name_repair = ~ c("var_name"))%>% 
  mutate(
    auc = map_dbl(.x = var_name, compute_auc)
  ) %>% 
  arrange(-auc)
```


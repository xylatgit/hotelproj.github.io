<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Model Building</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="bootstrap.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Need a Vacation? Book a Hotel!</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="home.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="eda.html">EDA</a>
</li>
<li>
  <a href="model.html">Model Building</a>
</li>
<li>
  <a href="report.html">Final Report</a>
</li>
<li>
  <a href="mailto:&lt;xl3048@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/xylatgit/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Model Building</h1>

</div>


<p><img src="images/model.jpg"><br />
<em>image source: google</em></p>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
</div>
<div id="logistic-regression" class="section level2">
<h2>Logistic Regression</h2>
<div id="regression-output" class="section level4">
<h4>Regression Output</h4>
<p>We used stepwise selection and concluded that all of our existing variables have statistical significance. We thus fitted this model to our dataset, and generated the following output for the variables with significant odds ratios:</p>
<table>
<caption>Logistic Regression Output</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">log_OR</th>
<th align="right">OR</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">deposit_typeNon Refund</td>
<td align="right">5.156</td>
<td align="right">173.389</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">market_segmentOnline TA</td>
<td align="right">1.479</td>
<td align="right">4.388</td>
<td align="right">0.007</td>
</tr>
<tr class="odd">
<td align="left">market_segmentDirect</td>
<td align="right">0.981</td>
<td align="right">2.668</td>
<td align="right">0.088</td>
</tr>
<tr class="even">
<td align="left">mealFB</td>
<td align="right">0.745</td>
<td align="right">2.106</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">market_segmentComplementary</td>
<td align="right">0.713</td>
<td align="right">2.041</td>
<td align="right">0.357</td>
</tr>
<tr class="even">
<td align="left">customer_typeTransient</td>
<td align="right">0.662</td>
<td align="right">1.938</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">market_segmentGroups</td>
<td align="right">0.656</td>
<td align="right">1.928</td>
<td align="right">0.230</td>
</tr>
<tr class="even">
<td align="left">market_segmentCorporate</td>
<td align="right">-1.645</td>
<td align="right">0.193</td>
<td align="right">0.004</td>
</tr>
<tr class="odd">
<td align="left">distribution_channelDirect</td>
<td align="right">-2.204</td>
<td align="right">0.110</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">distribution_channelGDS</td>
<td align="right">-2.874</td>
<td align="right">0.056</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p><strong>Comment</strong> As we can see from the output, deposit type: non refund has the largest odds ratio(173.389), indicating that the guests with non refundable test are significantly more likely to cancel the bookings compared to no deposit guests. This finding is rather counter-intuitive and also raises the question about the validity of the dataset.</p>
</div>
<div id="variable-importance" class="section level4">
<h4>Variable Importance</h4>
<p>We furthur generated the most important variables of our model:</p>
<table>
<caption>Variable Importance</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Overall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">total_of_special_requests</td>
<td align="right">48.779</td>
</tr>
<tr class="even">
<td align="left">deposit_typeNon Refund</td>
<td align="right">32.904</td>
</tr>
<tr class="odd">
<td align="left">lead_time</td>
<td align="right">30.214</td>
</tr>
<tr class="even">
<td align="left">adr</td>
<td align="right">17.725</td>
</tr>
<tr class="odd">
<td align="left">arrival_seasonSummer</td>
<td align="right">15.405</td>
</tr>
<tr class="even">
<td align="left">booking_changes</td>
<td align="right">12.763</td>
</tr>
<tr class="odd">
<td align="left">arrival_seasonSpring</td>
<td align="right">12.659</td>
</tr>
<tr class="even">
<td align="left">distribution_channelTA/TO</td>
<td align="right">10.285</td>
</tr>
</tbody>
</table>
<p>We will look more into the four most important features:<br />
* Total special requests * deposit type * adr<br />
<br></p>
<div id="the-special-request-effect" class="section level5">
<h5>The Special Request Effect</h5>
<div id="htmlwidget-5f751ad5b4939cf09d7d" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5f751ad5b4939cf09d7d">{"x":{"visdat":{"32d320d6931a":["function () ","plotlyVisDat"]},"cur_data":"32d320d6931a","attrs":{"32d320d6931a":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Canceled Proportion with Total Number of Special Request","xaxis":{"domain":[0,1],"automargin":true,"title":"Number of Special Requests"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion of Cancellation","range":[0,1]},"barmode":"group","hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,1,2,3,4,5],"y":[0.549242029317931,0.220401493930906,0.21358388602309,0.17643352236925,0.106060606060606,0.0384615384615385],"type":"bar","name":"City Hotel","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,2,3,4,5],"y":[0.322704709091722,0.219972895138065,0.233478350942614,0.182417582417582,0.105633802816901,0.0714285714285714],"type":"bar","name":"Resort Hotel","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Based on the proportion plot, we found that, for city hotel, the cancellation proportion is the highest when the guests didn’t ask for any special request. Similarly, for resort hotel, the cancellation proportion is also higher when guests didn’t ask for any special request.</p>
<p><br> ##### The Deposit Type Effect</p>
<div id="htmlwidget-18be61c87b48cc15bd3f" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-18be61c87b48cc15bd3f">{"x":{"visdat":{"32d3236227ba":["function () ","plotlyVisDat"]},"cur_data":"32d3236227ba","attrs":{"32d3236227ba":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Canceled Proportion with Deposit Type","xaxis":{"domain":[0,1],"automargin":true,"title":"Deposit Type","type":"category","categoryorder":"array","categoryarray":["No Deposit","Non Refund","Refundable"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion of Cancellation","range":[0,1]},"barmode":"group","hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["No Deposit","Non Refund","Refundable"],"y":[0.304686794497456,0.998134908299658,0.7],"text":["<br />Cancellation Proportion: 0.304686794497456","<br />Cancellation Proportion: 0.998134908299658","<br />Cancellation Proportion: 0.7"],"type":"bar","name":"City Hotel","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No Deposit","Non Refund","Refundable"],"y":[0.247388675096207,0.959860383944154,0.154929577464789],"text":["<br />Cancellation Proportion: 0.247388675096207","<br />Cancellation Proportion: 0.959860383944154","<br />Cancellation Proportion: 0.154929577464789"],"type":"bar","name":"Resort Hotel","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Based on the proportion plot, we found that for both resort and city hotels, reservations with non-refundable deposit have about 94% and 99% of cancellation respectively, which is significantly higher than other two types of deposits. For reservations with refundable deposit, we found that the cancellation of city hotel is relatively higher than that of resort hotel. This counter intuitive finding confirmed with the previous odds ratios. We therefore suspected the validity of this variable.</p>
<p><br> ##### The ADR Effect <div id="htmlwidget-839c02ecf06f3266995f" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-839c02ecf06f3266995f">{"x":{"visdat":{"32d3668b0776":["function () ","plotlyVisDat"]},"cur_data":"32d3668b0776","attrs":{"32d3668b0776":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"32d3668b0776.1":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Daily Rate (ADR) and Cancellation","xaxis":{"domain":[0,1],"automargin":true,"title":"ADR"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Cancellation Proportion"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,1,2,4,6,8,12,17.6,22.5,25,26,26.1,27,28.1,29,29.16,30,30.24,30.6,31,31.45,32,32.4,33,33.26,33.3,34,34.2,34.4,34.56,35,35.1,35.11,36,36.05,36.25,36.45,36.96,37,37.4,37.8,38,38.4,38.5,38.67,39,39.6,39.8,40,40.05,40.5,40.67,40.95,41,41.4,41.6,41.98,42,42.3,42.5,42.95,43,43.2,43.5,44,44.1,44.36,44.5,44.64,44.66,44.8,45,45.5,45.9,46,46.4,46.5,46.75,46.8,46.98,47,47.4,47.5,48,48.5,48.6,48.75,48.8,49,49.2,49.4,49.5,49.95,50,50.4,50.5,50.85,51,51.4,51.5,51.8,51.84,51.85,52,52.2,52.36,52.4,52.5,52.56,52.8,52.85,53,53.1,53.85,54,54.4,54.5,54.71,54.75,54.9,54.99,55,55.1,55.43,55.44,55.68,55.8,55.96,56,56.4,56.7,57,57.5,57.6,57.8,57.93,58,58.2,58.4,58.5,58.6,58.7,58.9,58.95,59,59.4,59.5,59.6,59.8,60,60.06,60.29,60.3,60.98,61,61.2,61.4,61.5,61.6,62,62.18,62.4,62.48,62.5,62.8,62.9,63,63.2,63.36,63.4,63.5,63.58,63.75,63.9,64,64.14,64.37,64.5,64.67,64.8,64.9,65,65.29,65.4,65.45,65.5,65.6,65.7,65.75,65.83,66,66.3,66.5,66.53,66.6,66.8,67,67.05,67.15,67.22,67.32,67.5,67.58,67.76,67.83,68,68.07,68.4,68.47,68.5,68.61,68.74,68.85,69,69.29,69.3,69.36,69.5,69.53,69.7,70,70.03,70.2,70.4,70.44,70.5,70.53,70.69,70.75,71,71.1,71.2,71.28,71.33,71.4,71.55,71.6,71.69,71.7,72,72.07,72.2,72.25,72.38,72.42,72.5,72.75,72.76,72.8,72.9,73,73.1,73.15,73.33,73.37,73.5,73.8,73.9,73.92,73.95,74,74.15,74.25,74.6,74.61,74.7,74.8,75,75.2,75.33,75.6,75.65,75.95,76,76.05,76.23,76.5,76.58,76.67,76.8,76.93,77,77.03,77.23,77.25,77.35,77.4,77.5,77.6,77.76,77.85,77.86,78,78.15,78.2,78.3,78.35,78.4,78.5,78.54,78.85,79,79.05,79.2,79.43,79.5,79.56,79.8,79.9,80,80.1,80.24,80.3,80.5,80.75,80.81,80.85,81,81.08,81.2,81.25,81.5,81.6,81.62,81.67,81.77,81.82,81.9,82,82.35,82.4,82.44,82.45,82.5,82.8,82.88,83,83.16,83.2,83.3,83.5,83.6,83.7,83.75,83.8,83.9,84,84.15,84.33,84.5,84.58,84.6,84.7,84.8,85,85.33,85.5,85.59,85.6,85.67,85.75,85.8,85.85,86,86.36,86.4,86.5,86.55,86.63,86.7,86.75,86.9,87,87.2,87.3,87.5,87.75,87.78,88,88.01,88.2,88.4,88.5,88.8,88.83,89,89.1,89.14,89.2,89.25,89.3,89.4,89.5,89.75,89.89,90,90.09,90.1,90.25,90.3,90.33,90.5,90.6,90.67,90.78,90.9,90.95,91,91.2,91.33,91.38,91.48,91.5,91.6,91.67,91.8,91.85,92,92.1,92.17,92.28,92.4,92.5,92.65,93,93.08,93.15,93.33,93.5,93.6,94,94.05,94.35,94.5,94.8,94.95,95,95.2,95.4,95.48,95.5,95.67,95.7,95.88,96,96.05,96.25,96.3,96.33,96.4,96.5,96.67,96.9,97,97.02,97.2,97.3,97.33,97.4,97.5,97.54,97.71,97.75,97.92,98,98.1,98.25,98.33,98.4,98.5,98.6,98.8,99,99.1,99.2,99.3,99.45,99.5,99.9,100,100.1,100.2,100.3,100.33,100.5,100.75,100.8,101,101.15,101.25,101.33,101.4,101.5,101.52,101.58,101.7,102,102.25,102.3,102.33,102.43,102.5,102.6,102.8,102.85,103,103.05,103.18,103.2,103.5,103.6,103.7,103.8,103.95,104,104.4,104.5,104.55,104.72,104.85,105,105.25,105.3,105.33,105.4,105.5,105.75,105.83,105.9,106,106.2,106.25,106.33,106.4,106.5,106.67,106.85,107,107.1,107.2,107.5,107.95,108,108.11,108.3,108.45,108.5,108.8,108.9,109,109.1,109.25,109.5,109.65,109.8,110,110.4,110.5,110.7,110.75,110.8,111,111.2,111.3,111.35,111.5,111.6,111.75,111.78,112,112.05,112.1,112.2,112.33,112.5,112.63,112.67,112.8,113,113.05,113.33,113.4,113.6,114,114.3,114.4,114.5,114.75,114.9,115,115.2,115.5,115.6,115.8,116,116.1,116.33,116.45,116.5,116.67,117,117.04,117.3,117.6,117.67,117.81,117.9,118,118.15,118.2,118.5,118.8,119,119.1,119.25,119.5,119.7,119.85,120,120.6,120.7,121,121.1,121.33,121.5,121.55,121.6,121.8,122,122.33,122.4,122.5,122.7,123,123.2,123.25,123.3,123.33,123.5,123.75,124,124.1,124.2,124.25,124.5,124.8,125,125.1,125.4,125.8,126,126.33,126.67,126.9,127,127.2,127.33,127.5,127.67,127.8,128,128.25,128.4,128.7,128.8,129,129.2,129.33,129.5,129.6,129.7,130,130.05,130.33,130.5,130.67,130.8,130.9,131,131.2,131.4,131.5,131.6,131.7,131.75,132,132.3,132.5,132.6,132.9,133,133.2,133.33,133.5,134,134.1,134.3,134.5,134.85,135,135.15,135.33,135.5,135.9,136,136.5,136.67,136.8,137,137.25,137.5,137.67,137.7,138,138.33,138.38,138.5,138.55,138.6,139,139.2,139.5,139.95,140,140.4,140.7,140.8,141,141.3,141.5,142,142.2,142.5,143,143.1,143.5,144,144.4,144.5,144.8,144.9,145,145.2,145.5,145.67,145.8,146,146.2,146.5,146.67,146.7,147,147.25,147.6,147.9,148,148.5,149,149.33,149.4,149.5,149.6,150,150.3,150.45,151,151.2,151.5,152,152.1,152.5,152.67,153,153.33,153.5,153.75,153.9,154,154.5,154.8,155,155.7,156,156.6,156.67,157,157.25,157.5,158,158.4,158.95,159,159.3,159.33,159.5,160,160.2,161,161.1,161.33,161.5,161.67,162,163,163.33,163.8,164,164.25,164.7,165,165.6,165.75,166,166.25,166.5,166.67,167,167.18,167.2,167.45,168,168.3,169,169.2,169.5,170,170.1,171,171.9,172,172.8,173,173.25,173.7,174,174.6,175,175.5,176,177,177.3,177.5,177.75,178,178.2,178.5,179,179.1,180,181,181.8,182,183,183.6,184,184.5,185,185.4,186,186.3,187,187.2,187.5,187.85,188,189,189.9,190,190.8,191,192,192.67,193,193.5,194,195,196,197,197.1,198,198.9,199,200,201,201.6,202,202.5,203,204,205,205.2,206,207,207.9,208,209,210,211,211.5,212,213,214,215,216,218,219,220,221,222,223,224,224.67,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,264,265,269,270,271,274,275,279,292,295,300,305],"y":[0.11,0.2,0.25,0.1,0.32,0.75,0.58,0.91,0.19,0.13,0.12,0.11,0.05,0,0.11,0.56,0.24,0.06,0.04,0.03,0.06,0.08,0.63,0,0.23,0.63,0.37,0.29,0.02,0,0.14,0.21,0,0.29,1,0.17,0.5,0.08,0.25,0.04,0.51,0.14,0.08,0,0.11,0.22,0.18,0,0.18,0.96,0.33,0,0.11,0.16,0.23,0,0,0.23,0.28,0.03,0,0.11,0.17,0,0.06,0.47,0.33,0.16,0.36,0.5,0.24,0.13,0.47,0.12,0.52,0.19,0.05,0.1,0.33,0.44,0.28,0.18,0,0.29,0.19,0.44,0,0,0.16,0.29,0,0.07,0.89,0.27,0.48,0,0.34,0.13,0.83,0.27,0,0.33,0.14,0.62,0.34,0.25,0.03,0.25,0.26,0.26,0,0.14,0.07,0,0.3,0.28,0.03,0.03,0,0.05,0.96,0.29,0.08,0.09,0.24,0.21,0.55,0.31,0.17,0.07,0.39,0.11,0.29,0.41,0.18,0,0.24,0,0.07,0.07,0.94,0,0.39,0.53,0.49,0.36,0.31,0,0,0.44,0.12,0.17,0.44,0.18,0.45,0.14,0,0.11,0,0.81,0.38,0.2,0,0.06,0.98,0.12,0.24,0.15,0.33,0.72,0.29,0.18,0.47,0.17,0.35,0,0,0.11,0.05,0.26,0,0.32,0.33,0.07,0.22,0.15,0.08,0.42,0,0.14,0.16,0.53,0.11,0,0.5,0.06,0.23,0.83,0.29,0.08,0.62,0.44,0.32,0,0,0.31,0.06,0.37,0.15,0.17,0.13,0,0.21,0.22,0.71,0.12,0.67,0.12,0.09,0.41,0.45,0.14,0.19,0.19,0,0,0.95,0.12,0.73,0.09,0.38,0.19,0.84,0.09,0.29,0.25,0.11,0,0,0.44,0.1,0,0.25,0.18,0.04,0.16,0.03,0.05,0.5,0.69,0.27,0.44,0.05,0.33,0.06,0.28,0.46,0.21,0,0.64,0.15,0.29,0.54,0.08,0.08,0.33,0.51,0.44,0,0.08,0.25,0.23,0,0.17,1,0,0.49,0.19,0.33,0,0.75,0.13,0.05,0.24,0.37,0.76,0.37,0.52,0.22,0.25,0.43,0.47,0.32,0.58,0.42,0.47,0.14,0.27,0.28,0,0.07,0.37,0.33,0.45,0.75,0.29,0.38,0.26,0.08,0.57,0.33,0.12,0.02,0,0.22,0,0.08,0.32,0.13,0.06,0.17,0.24,0.28,0,0.05,0.06,0.36,0.41,0.3,0.08,0.09,0.25,0.27,0.25,0.49,0.44,0.08,0.12,0.29,0.36,0.16,0.27,0.21,0,0,0.06,0.37,0.39,0.06,0.1,0.07,0.67,0.21,0.04,0.38,0.05,0.36,0.07,0.33,0.01,0.33,0.46,0.42,0.5,0.21,0.46,0.29,0,0.22,0.42,0.47,0.18,0.17,0.09,0.38,0.09,0.33,0.11,0.3,0,0.28,0.43,0.33,0.14,0.38,0.47,0.35,0,0.43,0.37,0.08,0.22,0.18,0.05,0.35,0.61,0.1,0.25,0.18,0.14,0.27,0.09,0.29,0.1,0,0.38,0.28,0.2,0.34,0.4,0.18,0.05,0.24,0.38,0.2,0.33,0.5,0.29,0.12,0.06,0.21,0.14,0.29,0.23,0.17,0.48,0.94,0.16,0.31,0.54,0.12,0.67,0.37,0.44,0.27,0.09,0.43,0.28,0.48,0.07,0,0.09,0.53,0.45,0.5,0.44,0.12,0.31,0.17,0.54,0.33,0.08,0.27,0.17,0.16,0.38,0.82,0.62,0,0.43,0.15,0.58,0.41,0.15,0.21,0.46,0.31,0.27,0.14,0.09,0.29,0.14,0.38,0,0.17,0.26,0.36,0.29,0.47,0.62,0.07,0.14,0.47,0,0.21,0,0.41,0.47,0.41,0.57,0.07,0.15,0.87,0,0.29,0.42,0.16,0.33,0.08,0.42,0.62,0.33,0.45,0,0.48,0.32,0.42,0,0.33,0.43,0.27,0.53,0.47,0.15,0.14,0.41,0.14,0.44,0.29,0.16,0.55,0,0.41,0.11,0.4,0.14,0.33,0.25,0.11,0.3,0.54,0.28,0.14,0.18,0.11,0.2,0,0.12,0.49,0.35,0,0.39,0.37,0.15,0.29,0.29,0.07,0.41,0.44,0.22,0,0.15,0.07,0.45,0.63,0.64,0.13,0.21,0.38,0.42,0.28,0.35,0.13,0.08,0.38,0,0.31,0.18,0.31,0.19,0.42,0,0.39,0.5,0.38,0.31,0.13,0.4,0.19,0.27,0.27,0.55,0.43,0.24,0.4,0.02,0.04,0.38,0.31,0.28,0.47,0.42,0.4,0,0.32,0.42,0.19,0.57,0.29,0.38,0.37,0.18,0.39,0.33,0.33,0.5,0.43,0.34,0.46,0.38,0.14,0.46,0.3,0.44,0.22,0.31,0.47,0.29,0.62,0.49,0.42,0.43,0.18,0.29,0.41,0.15,0.31,0.45,0.28,0.53,0.19,0.29,0.2,0.28,0.11,0.21,0.45,0.27,0.12,0.6,0.21,0.39,0.44,0.55,0.21,0.5,0.49,0.33,0.17,0.42,0.41,0.36,0.57,0.4,0.2,0.54,0.14,0.33,0.42,0.46,0.2,0.08,0.29,0.33,0.5,0.31,0.29,0.31,0.33,0.33,0.26,0.68,0.41,0.31,0.44,0.38,0.55,0.43,0.17,0.31,0.52,0.08,0.42,0.17,0.37,0.2,0.63,0.28,0.39,0.27,0.24,0.61,0.25,0.3,0.3,0.43,0.52,0.15,0.08,0.48,0.41,0.55,0.23,0.42,0.27,0.12,0.38,0.42,0.26,0.46,0.36,0.77,0.32,0.18,0.29,0.61,0.09,0.4,0.59,0.29,0.13,0.45,0.35,0.55,0.52,0.25,0.08,0.28,0.7,0.29,0.25,0.39,0.05,0.22,0.58,0.24,0.36,0,0.38,0.45,0.31,0.24,0.36,0.4,0.18,0.52,0.36,0.4,0.08,0.32,0.31,0.37,0.25,0.38,0.44,0.19,0.39,0.24,0.67,0.44,0.29,0.38,0.31,0.6,0.37,0.34,0.33,0.26,0.26,0.43,0.64,0.57,0.31,0.27,0.18,0.86,0.43,0.28,0.33,0.56,0.46,0.24,0.35,0.48,0.27,0.12,0.37,0.4,0.38,0.24,0.48,0.28,0.52,0.38,0.11,0.54,0.35,0.2,0.18,0.23,0.33,0.25,0.37,0.29,0.42,0.28,0.26,0.62,0.65,0.25,0.38,0.5,0.31,0.17,0.47,0.27,0.35,1,0.36,0.62,0.41,0.42,0.29,0.33,0.08,0.6,0.21,0.37,0.19,0.23,0.63,0.34,0.6,0.15,0.33,0.59,0.27,0.48,0.29,0.18,0.45,0.44,0.5,0.31,0.4,0.17,0.32,0.34,0.41,0.23,0.58,0.38,0.26,0.54,0.28,0.32,0.17,0.54,0.35,0.36,0.32,0.45,0.22,0.47,0.2,0.45,0.42,0.48,0.48,0.28,0.42,0,0.4,0.5,0.36,0.46,0.25,0.16,0.85,0.55,0.53,0.44,0.45,0.16,0.71,0.32,0.45,0.27,0.3,0.48,0.27,0.32,0.49,0.46,0.21,0.43,0.4,0.34,0.27,0.61,0.41,0.46,0.37,0.3,0.47,0.42,0.45,0.38,0.54,0.3,0.37,0,0.54,0.47,0.29,0.4,0.49,0.55,0.39,0.41,0.3,0.33,0.34,0.2,0.59,0.46,0.33,0.53,0.4,0.39,0.2,0.33,0.32,0.3,0.29,0.56,0.36,0.58,0.21,0.66,0.07,0.47,0.47,0.33,0.55,0.3,0.5,0.43,0.2,0.55,0.31,0.45,0.35,0.44,0.14,0.31,0.43,0.25,0.82,0.19,0.14,0.13],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,2,4,6,8,12,17.6,22.5,25,26,26.1,27,28.1,29,29.16,30,30.24,30.6,31,31.45,32,32.4,33,33.26,33.3,34,34.2,34.4,34.56,35,35.1,35.11,36,36.05,36.25,36.45,36.96,37,37.4,37.8,38,38.4,38.5,38.67,39,39.6,39.8,40,40.05,40.5,40.67,40.95,41,41.4,41.6,41.98,42,42.3,42.5,42.95,43,43.2,43.5,44,44.1,44.36,44.5,44.64,44.66,44.8,45,45.5,45.9,46,46.4,46.5,46.75,46.8,46.98,47,47.4,47.5,48,48.5,48.6,48.75,48.8,49,49.2,49.4,49.5,49.95,50,50.4,50.5,50.85,51,51.4,51.5,51.8,51.84,51.85,52,52.2,52.36,52.4,52.5,52.56,52.8,52.85,53,53.1,53.85,54,54.4,54.5,54.71,54.75,54.9,54.99,55,55.1,55.43,55.44,55.68,55.8,55.96,56,56.4,56.7,57,57.5,57.6,57.8,57.93,58,58.2,58.4,58.5,58.6,58.7,58.9,58.95,59,59.4,59.5,59.6,59.8,60,60.06,60.29,60.3,60.98,61,61.2,61.4,61.5,61.6,62,62.18,62.4,62.48,62.5,62.8,62.9,63,63.2,63.36,63.4,63.5,63.58,63.75,63.9,64,64.14,64.37,64.5,64.67,64.8,64.9,65,65.29,65.4,65.45,65.5,65.6,65.7,65.75,65.83,66,66.3,66.5,66.53,66.6,66.8,67,67.05,67.15,67.22,67.32,67.5,67.58,67.76,67.83,68,68.07,68.4,68.47,68.5,68.61,68.74,68.85,69,69.29,69.3,69.36,69.5,69.53,69.7,70,70.03,70.2,70.4,70.44,70.5,70.53,70.69,70.75,71,71.1,71.2,71.28,71.33,71.4,71.55,71.6,71.69,71.7,72,72.07,72.2,72.25,72.38,72.42,72.5,72.75,72.76,72.8,72.9,73,73.1,73.15,73.33,73.37,73.5,73.8,73.9,73.92,73.95,74,74.15,74.25,74.6,74.61,74.7,74.8,75,75.2,75.33,75.6,75.65,75.95,76,76.05,76.23,76.5,76.58,76.67,76.8,76.93,77,77.03,77.23,77.25,77.35,77.4,77.5,77.6,77.76,77.85,77.86,78,78.15,78.2,78.3,78.35,78.4,78.5,78.54,78.85,79,79.05,79.2,79.43,79.5,79.56,79.8,79.9,80,80.1,80.24,80.3,80.5,80.75,80.81,80.85,81,81.08,81.2,81.25,81.5,81.6,81.62,81.67,81.77,81.82,81.9,82,82.35,82.4,82.44,82.45,82.5,82.8,82.88,83,83.16,83.2,83.3,83.5,83.6,83.7,83.75,83.8,83.9,84,84.15,84.33,84.5,84.58,84.6,84.7,84.8,85,85.33,85.5,85.59,85.6,85.67,85.75,85.8,85.85,86,86.36,86.4,86.5,86.55,86.63,86.7,86.75,86.9,87,87.2,87.3,87.5,87.75,87.78,88,88.01,88.2,88.4,88.5,88.8,88.83,89,89.1,89.14,89.2,89.25,89.3,89.4,89.5,89.75,89.89,90,90.09,90.1,90.25,90.3,90.33,90.5,90.6,90.67,90.78,90.9,90.95,91,91.2,91.33,91.38,91.48,91.5,91.6,91.67,91.8,91.85,92,92.1,92.17,92.28,92.4,92.5,92.65,93,93.08,93.15,93.33,93.5,93.6,94,94.05,94.35,94.5,94.8,94.95,95,95.2,95.4,95.48,95.5,95.67,95.7,95.88,96,96.05,96.25,96.3,96.33,96.4,96.5,96.67,96.9,97,97.02,97.2,97.3,97.33,97.4,97.5,97.54,97.71,97.75,97.92,98,98.1,98.25,98.33,98.4,98.5,98.6,98.8,99,99.1,99.2,99.3,99.45,99.5,99.9,100,100.1,100.2,100.3,100.33,100.5,100.75,100.8,101,101.15,101.25,101.33,101.4,101.5,101.52,101.58,101.7,102,102.25,102.3,102.33,102.43,102.5,102.6,102.8,102.85,103,103.05,103.18,103.2,103.5,103.6,103.7,103.8,103.95,104,104.4,104.5,104.55,104.72,104.85,105,105.25,105.3,105.33,105.4,105.5,105.75,105.83,105.9,106,106.2,106.25,106.33,106.4,106.5,106.67,106.85,107,107.1,107.2,107.5,107.95,108,108.11,108.3,108.45,108.5,108.8,108.9,109,109.1,109.25,109.5,109.65,109.8,110,110.4,110.5,110.7,110.75,110.8,111,111.2,111.3,111.35,111.5,111.6,111.75,111.78,112,112.05,112.1,112.2,112.33,112.5,112.63,112.67,112.8,113,113.05,113.33,113.4,113.6,114,114.3,114.4,114.5,114.75,114.9,115,115.2,115.5,115.6,115.8,116,116.1,116.33,116.45,116.5,116.67,117,117.04,117.3,117.6,117.67,117.81,117.9,118,118.15,118.2,118.5,118.8,119,119.1,119.25,119.5,119.7,119.85,120,120.6,120.7,121,121.1,121.33,121.5,121.55,121.6,121.8,122,122.33,122.4,122.5,122.7,123,123.2,123.25,123.3,123.33,123.5,123.75,124,124.1,124.2,124.25,124.5,124.8,125,125.1,125.4,125.8,126,126.33,126.67,126.9,127,127.2,127.33,127.5,127.67,127.8,128,128.25,128.4,128.7,128.8,129,129.2,129.33,129.5,129.6,129.7,130,130.05,130.33,130.5,130.67,130.8,130.9,131,131.2,131.4,131.5,131.6,131.7,131.75,132,132.3,132.5,132.6,132.9,133,133.2,133.33,133.5,134,134.1,134.3,134.5,134.85,135,135.15,135.33,135.5,135.9,136,136.5,136.67,136.8,137,137.25,137.5,137.67,137.7,138,138.33,138.38,138.5,138.55,138.6,139,139.2,139.5,139.95,140,140.4,140.7,140.8,141,141.3,141.5,142,142.2,142.5,143,143.1,143.5,144,144.4,144.5,144.8,144.9,145,145.2,145.5,145.67,145.8,146,146.2,146.5,146.67,146.7,147,147.25,147.6,147.9,148,148.5,149,149.33,149.4,149.5,149.6,150,150.3,150.45,151,151.2,151.5,152,152.1,152.5,152.67,153,153.33,153.5,153.75,153.9,154,154.5,154.8,155,155.7,156,156.6,156.67,157,157.25,157.5,158,158.4,158.95,159,159.3,159.33,159.5,160,160.2,161,161.1,161.33,161.5,161.67,162,163,163.33,163.8,164,164.25,164.7,165,165.6,165.75,166,166.25,166.5,166.67,167,167.18,167.2,167.45,168,168.3,169,169.2,169.5,170,170.1,171,171.9,172,172.8,173,173.25,173.7,174,174.6,175,175.5,176,177,177.3,177.5,177.75,178,178.2,178.5,179,179.1,180,181,181.8,182,183,183.6,184,184.5,185,185.4,186,186.3,187,187.2,187.5,187.85,188,189,189.9,190,190.8,191,192,192.67,193,193.5,194,195,196,197,197.1,198,198.9,199,200,201,201.6,202,202.5,203,204,205,205.2,206,207,207.9,208,209,210,211,211.5,212,213,214,215,216,218,219,220,221,222,223,224,224.67,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,264,265,269,270,271,274,275,279,292,295,300,305],"y":[0.201330357667104,0.202212936053962,0.203095514440822,0.204860671214545,0.206625827988269,0.208390984761993,0.21192129830944,0.216863737275866,0.221188371371489,0.223394817338644,0.224277395725506,0.224365653564192,0.225159974112368,0.226130810337916,0.226925130886091,0.227066343427989,0.227807709272953,0.2280195280858,0.22833725630507,0.228690287659815,0.229087447933903,0.229572866046677,0.229925897401422,0.230455444433539,0.230684914814123,0.230720217949597,0.2313380228204,0.231514538497773,0.231691054175145,0.231832266717043,0.232220601207262,0.232308859045949,0.232317684829817,0.233103179594124,0.233147308513467,0.23332382419084,0.233500339868212,0.233950454845512,0.233985757980986,0.234338789335731,0.234691820690475,0.234868336367848,0.235221367722593,0.235309625561279,0.235459663887045,0.23575091475471,0.236280461786827,0.236456977464199,0.236633493141572,0.236677622060915,0.237074782335002,0.237224820660769,0.23747194260909,0.237516071528433,0.237869102883178,0.23804561856055,0.238380998347558,0.238398649915295,0.238663423431354,0.238839939108726,0.239237099382814,0.239281228302157,0.239457743979529,0.239722517495588,0.240163806689019,0.240252064527705,0.240481534908289,0.24060509588245,0.24072865685661,0.240746308424348,0.240869869398508,0.241046385075881,0.241487674269312,0.241840705624056,0.241928963462743,0.242281994817487,0.242370252656173,0.242590897252889,0.242635026172232,0.242793890281867,0.242811541849604,0.243164573204349,0.243252831043035,0.243694120236466,0.244135409429897,0.244223667268583,0.244356054026613,0.244400182945956,0.244576698623328,0.2447532143007,0.244929729978073,0.245017987816759,0.245415148090847,0.24545927701019,0.245812308364935,0.245900566203621,0.246209468639022,0.246341855397052,0.246694886751796,0.246783144590483,0.247047918106541,0.247083221242016,0.247092047025884,0.247224433783914,0.247400949461286,0.247542162003184,0.247577465138658,0.247665722977344,0.247718677680556,0.247930496493403,0.247974625412746,0.248107012170775,0.248195270009462,0.248857203799608,0.248989590557637,0.249342621912382,0.249430879751068,0.249616221212309,0.249651524347784,0.249783911105813,0.24986334316063,0.249872168944499,0.249960426783185,0.25025167765085,0.250260503434718,0.250472322247565,0.250578231653988,0.250719444195886,0.250754747331361,0.251107778686106,0.251372552202164,0.251637325718223,0.252078614911654,0.25216687275034,0.252343388427712,0.252458123618004,0.252519904105085,0.252696419782457,0.252872935459829,0.252961193298515,0.253049451137202,0.253137708975888,0.25331422465326,0.253358353572603,0.253402482491946,0.253755513846691,0.253843771685377,0.253932029524063,0.254108545201436,0.254285060878808,0.25433801558202,0.254541008610998,0.254549834394867,0.255149987697933,0.25516763926567,0.255344154943042,0.255520670620415,0.255608928459101,0.255697186297787,0.256050217652532,0.256209081762167,0.256403249007277,0.256473855278226,0.256491506845963,0.256756280362021,0.256844538200708,0.256932796039394,0.257109311716766,0.257250524258664,0.257285827394138,0.257374085232825,0.257444691503774,0.25759472982954,0.257727116587569,0.257815374426256,0.257938935400416,0.258141928429394,0.258256663619686,0.258406701945453,0.258521437135745,0.258609694974431,0.258697952813117,0.258953900545307,0.259050984167862,0.259095113087205,0.259139242006548,0.259227499845234,0.259315757683921,0.259359886603264,0.259430492874213,0.259580531199979,0.259845304716038,0.26002182039341,0.260048297745016,0.260110078232096,0.260286593909469,0.260463109586841,0.260507238506184,0.26059549634487,0.260657276831951,0.260745534670637,0.260904398780272,0.260975005051221,0.261133869160856,0.261195649647936,0.261345687973703,0.261407468460783,0.261698719328448,0.261760499815528,0.261786977167134,0.261884060789689,0.261998795979981,0.262095879602535,0.262228266360565,0.262484214092755,0.262493039876623,0.262545994579835,0.262669555553996,0.262696032905602,0.262846071231368,0.263110844747427,0.263137322099032,0.263287360424799,0.263463876102171,0.263499179237646,0.263552133940857,0.263578611292463,0.263719823834361,0.263772778537573,0.263993423134288,0.264081680972975,0.264169938811661,0.26424054508261,0.264284674001953,0.264346454489033,0.264478841247062,0.264522970166405,0.264602402221223,0.264611228005092,0.26487600152115,0.264937782008231,0.265052517198523,0.265096646117866,0.265211381308158,0.265246684443632,0.265317290714581,0.265537935311297,0.265546761095165,0.26558206423064,0.265670322069326,0.265758579908012,0.265846837746698,0.265890966666041,0.266049830775676,0.266085133911151,0.266199869101443,0.266464642617501,0.266552900456188,0.266570552023925,0.266597029375531,0.266641158294874,0.266773545052903,0.266861802891589,0.267170705326991,0.26717953111086,0.267258963165677,0.267347221004363,0.267523736681736,0.267700252359108,0.2678149875494,0.268053283713853,0.268097412633196,0.268362186149254,0.268406315068598,0.268450443987941,0.268609308097576,0.268847604262028,0.268918210532977,0.268997642587795,0.269112377778087,0.269227112968379,0.269288893455459,0.269315370807065,0.269491886484438,0.269509538052175,0.269597795890861,0.269641924810204,0.26973018264889,0.269818440487576,0.269959653029474,0.270039085084292,0.270047910868161,0.270171471842321,0.27030385860035,0.270347987519694,0.27043624535838,0.270480374277723,0.270524503197066,0.270612761035752,0.270648064171227,0.270921663471154,0.271054050229183,0.271098179148526,0.271230565906555,0.271433558935534,0.271495339422614,0.271548294125826,0.271760112938673,0.271848370777359,0.271936628616045,0.272024886454731,0.272148447428892,0.272201402132103,0.272377917809476,0.272598562406191,0.272651517109403,0.272686820244877,0.272819207002907,0.272889813273856,0.272995722680279,0.273039851599622,0.273260496196338,0.273348754035024,0.273366405602761,0.273410534522104,0.27349879236079,0.273542921280133,0.273613527551082,0.273701785389769,0.27401068782517,0.274054816744513,0.274090119879988,0.274098945663856,0.274143074583199,0.274407848099258,0.274478454370207,0.27458436377663,0.274725576318528,0.274760879454003,0.274849137292689,0.275025652970061,0.275113910808747,0.275202168647434,0.275246297566777,0.27529042648612,0.275378684324806,0.275466942163492,0.275599328921522,0.275758193031157,0.275908231356923,0.275978837627872,0.275996489195609,0.276084747034296,0.276173004872982,0.276349520550354,0.276640771418018,0.276790809743785,0.276870241798603,0.276879067582471,0.276940848069551,0.2770114543405,0.277055583259844,0.277099712179187,0.277232098937216,0.277549827156486,0.277585130291961,0.277673388130647,0.27771751704999,0.277788123320939,0.277849903808019,0.277894032727362,0.278026419485392,0.278114677324078,0.27829119300145,0.278379450840136,0.278555966517509,0.278776611114224,0.27880308846583,0.27899725571094,0.279006081494808,0.279173771388312,0.279350287065684,0.27943854490437,0.279703318420429,0.279729795772035,0.279879834097801,0.279968091936488,0.280003395071962,0.280056349775174,0.280100478694517,0.28014460761386,0.280232865452546,0.280321123291232,0.280541767887948,0.280665328862108,0.280762412484663,0.280841844539481,0.280850670323349,0.280983057081379,0.281027186000722,0.281053663352328,0.281203701678094,0.28129195951678,0.281353740003861,0.281450823626415,0.281556733032839,0.281600861952182,0.281644990871525,0.281821506548897,0.281936241739189,0.281980370658533,0.282068628497219,0.282086280064956,0.282174537903642,0.282236318390722,0.282351053581015,0.282395182500358,0.282527569258387,0.282615827097073,0.282677607584153,0.282774691206708,0.282880600613132,0.282968858451818,0.283101245209847,0.283410147645249,0.283480753916198,0.283542534403278,0.283701398512913,0.28385143683868,0.283939694677366,0.284292726032111,0.284336854951454,0.284601628467512,0.284734015225541,0.2849987887416,0.285131175499629,0.285175304418972,0.285351820096345,0.285528335773717,0.285598942044666,0.285616593612403,0.28576663193817,0.285793109289776,0.285951973399411,0.286057882805834,0.286102011725177,0.28627852740255,0.286322656321893,0.286349133673499,0.286410914160579,0.286499171999265,0.286649210325032,0.28685220335401,0.286940461192696,0.286958112760433,0.287116976870068,0.287205234708755,0.28723171206036,0.287293492547441,0.287381750386127,0.287417053521601,0.287567091847368,0.287602394982842,0.287752433308609,0.287823039579558,0.287911297418244,0.288043684176273,0.288114290447222,0.288176070934303,0.288264328772989,0.288352586611675,0.288529102289047,0.28870561796642,0.288793875805106,0.288882133643792,0.288970391482478,0.289102778240508,0.289146907159851,0.289499938514595,0.289588196353282,0.289676454191968,0.289764712030654,0.28985296986934,0.289879447220946,0.290029485546712,0.290250130143428,0.290294259062771,0.290470774740143,0.290603161498173,0.290691419336859,0.290762025607808,0.290823806094888,0.290912063933574,0.290929715501312,0.290982670204523,0.291088579610947,0.291353353127005,0.291573997723721,0.291618126643064,0.29164460399467,0.291732861833356,0.291794642320436,0.291882900159122,0.292059415836495,0.292103544755838,0.292235931513867,0.29228006043321,0.292394795623502,0.292412447191239,0.292677220707298,0.292765478545984,0.29285373638467,0.292941994223357,0.293074380981386,0.293118509900729,0.293471541255474,0.29355979909416,0.293603928013503,0.293753966339269,0.293868701529561,0.294001088287591,0.294221732884306,0.294265861803649,0.294292339155255,0.294354119642335,0.294442377481022,0.294663022077737,0.294733628348686,0.294795408835766,0.294883666674453,0.295060182351825,0.295104311271168,0.295174917542117,0.295236698029197,0.295324955867884,0.29547499419365,0.295633858303285,0.295766245061314,0.295854502900001,0.295942760738687,0.296207534254745,0.296604694528833,0.296648823448176,0.296745907070731,0.296913596964235,0.297045983722264,0.297090112641607,0.297354886157666,0.297443143996352,0.297531401835038,0.297619659673724,0.297752046431754,0.297972691028469,0.298105077786498,0.298237464544528,0.2984139802219,0.298767011576645,0.298855269415331,0.299031785092703,0.299075914012046,0.299120042931389,0.299296558608762,0.299473074286134,0.29956133212482,0.299605461044163,0.299737847802193,0.299826105640879,0.299958492398908,0.299984969750514,0.300179136995624,0.300223265914967,0.30026739483431,0.300355652672996,0.300470387863288,0.300620426189054,0.300735161379347,0.300770464514821,0.300885199705113,0.301061715382485,0.301105844301829,0.30135296625015,0.30141474673723,0.301591262414603,0.301944293769347,0.302209067285406,0.302297325124092,0.302385582962778,0.302606227559494,0.302738614317523,0.302826872156209,0.303003387833581,0.30326816134964,0.303356419188326,0.303532934865699,0.303709450543071,0.303797708381757,0.304000701410735,0.304106610817159,0.304150739736502,0.304300778062268,0.304592028929933,0.304627332065407,0.304856802445991,0.30512157596205,0.30518335644913,0.305306917423291,0.305386349478108,0.305474607316795,0.305606994074824,0.305651122994167,0.305915896510226,0.306180670026284,0.306357185703656,0.306445443542343,0.306577830300372,0.306798474897087,0.30697499057446,0.307107377332489,0.307239764090518,0.307769311122635,0.307857568961322,0.30812234247738,0.308210600316066,0.308413593345044,0.308563631670811,0.308607760590154,0.308651889509497,0.30882840518687,0.309004920864242,0.309296171731906,0.309357952218987,0.309446210057673,0.309622725735045,0.309887499251104,0.310064014928476,0.310108143847819,0.310152272767162,0.310178750118768,0.310328788444535,0.31054943304125,0.310770077637966,0.310858335476652,0.310946593315338,0.310990722234681,0.311211366831396,0.311476140347455,0.311652656024828,0.311740913863514,0.312005687379572,0.312358718734317,0.312535234411689,0.312826485279354,0.313126561930887,0.313329554959865,0.313417812798551,0.313594328475924,0.313709063666216,0.313859101991982,0.314009140317749,0.314123875508041,0.314300391185413,0.314521035782128,0.314653422540158,0.314918196056216,0.315006453894902,0.315182969572275,0.315359485249647,0.315474220439939,0.315624258765706,0.315712516604392,0.315800774443078,0.316065547959137,0.31610967687848,0.316356798826801,0.316506837152568,0.316656875478334,0.316771610668626,0.316859868507312,0.316948126345998,0.317124642023371,0.317301157700743,0.317389415539429,0.317477673378116,0.317565931216802,0.317610060136145,0.31783070473286,0.318095478248919,0.318271993926291,0.318360251764977,0.318625025281036,0.318713283119722,0.318889798797095,0.319004533987387,0.319154572313153,0.319595861506584,0.31968411934527,0.319860635022643,0.320037150700015,0.320346053135417,0.320478439893446,0.320610826651475,0.32076969076111,0.320919729086877,0.321272760441621,0.321361018280308,0.321802307473739,0.321952345799505,0.322067080989797,0.322243596667169,0.322464241263885,0.3226848858606,0.322834924186367,0.322861401537973,0.323126175054031,0.323417425921696,0.323461554841039,0.323567464247462,0.323611593166805,0.323655722086148,0.324008753440893,0.324185269118266,0.324450042634324,0.324847202908412,0.324891331827755,0.3252443631825,0.325509136698558,0.325597394537244,0.325773910214617,0.326038683730675,0.326215199408048,0.326656488601479,0.326833004278851,0.32709777779491,0.32753906698834,0.327627324827027,0.327980356181771,0.328421645375202,0.328774676729947,0.328862934568633,0.329127708084692,0.329215965923378,0.329304223762064,0.329480739439437,0.329745512955495,0.329895551281262,0.330010286471554,0.330186802148926,0.330363317826298,0.330628091342357,0.330778129668123,0.330804607019729,0.331069380535788,0.331290025132503,0.331598927567905,0.331863701083963,0.33195195892265,0.332393248116081,0.332834537309511,0.333125788177176,0.333187568664256,0.333275826502942,0.333364084341629,0.333717115696373,0.333981889212432,0.334114275970461,0.334599694083235,0.334776209760608,0.335040983276666,0.335482272470097,0.335570530308783,0.335923561663528,0.336073599989294,0.336364850856959,0.336656101724623,0.33680614005039,0.337026784647105,0.337159171405134,0.337247429243821,0.337688718437252,0.33795349195331,0.338130007630682,0.338747812501486,0.339012586017544,0.339542133049661,0.339603913536742,0.339895164404406,0.340115809001122,0.340336453597837,0.340777742791268,0.341130774146013,0.341616192258787,0.34166032117813,0.341925094694188,0.341951572045794,0.342101610371561,0.342542899564992,0.342719415242364,0.343425477951854,0.34351373579054,0.343716728819518,0.343866767145284,0.344016805471051,0.344308056338715,0.345190634725577,0.345481885593242,0.345896697435067,0.346073213112439,0.346293857709154,0.346691017983242,0.346955791499301,0.347485338531418,0.347617725289447,0.347838369886163,0.348059014482878,0.348279659079594,0.34842969740536,0.348720948273025,0.34887981238266,0.348897463950397,0.349118108547112,0.349603526659886,0.349868300175945,0.350486105046748,0.350662620724121,0.350927394240179,0.35136868343361,0.351456941272296,0.352251261820472,0.353045582368647,0.353133840207334,0.353839902916823,0.354016418594196,0.354237063190911,0.354634223464999,0.354898996981057,0.355428544013174,0.355781575367919,0.35622286456135,0.356664153754781,0.357546732141643,0.357811505657701,0.357988021335074,0.358208665931789,0.358429310528505,0.358605826205877,0.358870599721936,0.359311888915367,0.359400146754053,0.360194467302228,0.36107704568909,0.36178310839858,0.361959624075952,0.362842202462814,0.363371749494931,0.363724780849676,0.364166070043107,0.364607359236538,0.364960390591282,0.365489937623399,0.365754711139458,0.366372516010261,0.366549031687634,0.366813805203692,0.367122707639094,0.367255094397123,0.368137672783985,0.368931993332161,0.369020251170847,0.369726313880336,0.369902829557709,0.37078540794457,0.371376735463768,0.371667986331432,0.372109275524863,0.372550564718294,0.373433143105156,0.374315721492018,0.37519829987888,0.375286557717566,0.376080878265741,0.376875198813917,0.376963456652603,0.377846035039465,0.378728613426327,0.379258160458444,0.379611191813189,0.38005248100662,0.380493770200051,0.381376348586912,0.382258926973774,0.382435442651147,0.383141505360636,0.384024083747498,0.384818404295674,0.38490666213436,0.385789240521222,0.386671818908083,0.387554397294945,0.387995686488376,0.388436975681807,0.389319554068669,0.390202132455531,0.391084710842393,0.391967289229254,0.393732446002978,0.39461502438984,0.395497602776702,0.396380181163564,0.397262759550425,0.398145337937287,0.399027916324149,0.399619243843347,0.399910494711011,0.400793073097873,0.401675651484735,0.402558229871596,0.403440808258458,0.40432338664532,0.405205965032182,0.406088543419044,0.406971121805906,0.407853700192767,0.408736278579629,0.409618856966491,0.410501435353353,0.411384013740215,0.412266592127077,0.413149170513938,0.4140317489008,0.414914327287662,0.415796905674524,0.416679484061386,0.417562062448248,0.418444640835109,0.419327219221971,0.420209797608833,0.421092375995695,0.421974954382557,0.422857532769419,0.42374011115628,0.424622689543142,0.425505267930004,0.426387846316866,0.427270424703728,0.42815300309059,0.429035581477451,0.429918159864313,0.430800738251175,0.431683316638037,0.432565895024899,0.434331051798622,0.435213630185484,0.438743943732932,0.439626522119793,0.440509100506655,0.443156835667241,0.444039414054103,0.44756972760155,0.459043246630754,0.461690981791339,0.466103873725649,0.470516765659958],"mode":"lines","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script></p>
<p>From this plot, there is no clear trend detected. We see that the proportion of cancelation slight increases with increase in ADR.</p>
</div>
</div>
<div id="cross-validation" class="section level4">
<h4>Cross Validation</h4>
<p>Since we are questioning the validity of deposit type, we fitted the logistic regression models without the deposit type. We then compared the prediction accuracy of the two models:</p>
<table>
<caption>Model Accuracy</caption>
<thead>
<tr class="header">
<th align="right">Model1 accuracy</th>
<th align="right">Model2 accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.757</td>
<td align="right">0.749</td>
</tr>
</tbody>
</table>
<p>We can see that the two models have roughly the same prediction accuracy! We also generated the ROC for comparison:<br />
<img src="model_files/figure-html/unnamed-chunk-5-1.png" width="80%" /></p>
</div>
<div id="model-diagnosis" class="section level4">
<h4>Model Diagnosis</h4>
<pre class="r"><code>train_df =
  broom::augment(logistic_fit_2) %&gt;% 
  mutate(index = 1:n()) 

ggplot(data = train_df, aes(index, .std.resid, color = &quot;viridis&quot;)) + 
  geom_point(alpha = .5) +
  geom_ref_line(h = 3) + 
  labs(title = &quot;Residual Deviance plot&quot;)</code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-6-1.png" width="80%" /></p>
<pre class="r"><code>plot(logistic_fit_2, which = 4, id.n = 5)</code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-6-2.png" width="80%" /></p>
<p>We created the residual deviance plot to detect outliers. And as shown in the plot, those standardized residuals that exceed 3 represent possible outliers and may deserve closer attention. Similarly, plotting the cook’s distance also signals some potential outliers in our dataset.</p>
</div>
</div>
<div id="random-forest" class="section level2">
<h2>Random Forest</h2>
<div id="check-nas" class="section level4">
<h4>Check NAs</h4>
<p><img src="model_files/figure-html/rf_NA-1.png" width="80%" /> From the plot we do not any NAs in the dataset.</p>
</div>
<div id="random-forest-model" class="section level4">
<h4>Random Forest Model</h4>
<pre><code>## 
## Call:
##  randomForest(formula = is_canceled ~ ., data = train, importance = T) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 3
## 
##         OOB estimate of  error rate: 14.98%
## Confusion matrix:
##       0     1 class.error
## 0 27343  1788  0.06137791
## 1  5019 11278  0.30797079</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">class.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">27343</td>
<td align="right">1788</td>
<td align="right">0.061</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">5019</td>
<td align="right">11278</td>
<td align="right">0.308</td>
</tr>
</tbody>
</table>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1
##          0 6790 1251
##          1  449 2789
##                                           
##                Accuracy : 0.8493          
##                  95% CI : (0.8425, 0.8558)
##     No Information Rate : 0.6418          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.6571          
##                                           
##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16       
##                                           
##             Sensitivity : 0.9380          
##             Specificity : 0.6903          
##          Pos Pred Value : 0.8444          
##          Neg Pred Value : 0.8613          
##              Prevalence : 0.6418          
##          Detection Rate : 0.6020          
##    Detection Prevalence : 0.7129          
##       Balanced Accuracy : 0.8142          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<p>Train:Test = 8:2   The error rate for the model is 14.98%. The accuracy of the model on test set is 84.93%.</p>
</div>
<div id="error-rate" class="section level4">
<h4>Error Rate</h4>
<p><img src="model_files/figure-html/rf%20error%20rate-1.png" width="80%" /></p>
<p>From the plot on error rate for random forest model, we can see that the error rate does not change much after 100.</p>
</div>
<div id="tune-mtry" class="section level4">
<h4>Tune mtry</h4>
<pre><code>## mtry = 3  OOB error = 15.1% 
## Searching left ...
## mtry = 6     OOB error = 14.12% 
## 0.06515085 0.05 
## mtry = 12    OOB error = 14.78% 
## -0.04661678 0.05 
## Searching right ...
## mtry = 1     OOB error = 23.48% 
## -0.6630808 0.05</code></pre>
<p><img src="model_files/figure-html/tune%20mtry-1.png" width="80%" /></p>
<pre><code>##        mtry  OOBError
## 1.OOB     1 0.2348111
## 3.OOB     3 0.1510302
## 6.OOB     6 0.1411905
## 12.OOB   12 0.1477723</code></pre>
<p>Mtry refers to the number of variables available for splitting at each tree node.<br />
For tuning Mtry, we set paramter <em>ntreeTry</em> (number of trees used at tuning step) to 200, since from the error rate plot we can see that ER does not change much after 200.<br />
From the plot we can see that the OOB (Out of Bag Error) is very high when Mtry is 1, and goes down at Mtry equal 3, and reaches the bottom at Mtry equals 6, then bounces back.</p>
</div>
<div id="tuned-rf-model" class="section level4">
<h4>Tuned RF model</h4>
<pre><code>## 
## Call:
##  randomForest(formula = is_canceled ~ ., data = train, importance = TRUE,      mtry = 6, ntree = 200) 
##                Type of random forest: classification
##                      Number of trees: 200
## No. of variables tried at each split: 6
## 
##         OOB estimate of  error rate: 14.19%
## Confusion matrix:
##       0     1 class.error
## 0 26682  2449  0.08406852
## 1  3996 12301  0.24519850</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1
##          0 6628  982
##          1  611 3058
##                                           
##                Accuracy : 0.8588          
##                  95% CI : (0.8522, 0.8651)
##     No Information Rate : 0.6418          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.6865          
##                                           
##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16       
##                                           
##             Sensitivity : 0.9156          
##             Specificity : 0.7569          
##          Pos Pred Value : 0.8710          
##          Neg Pred Value : 0.8335          
##              Prevalence : 0.6418          
##          Detection Rate : 0.5876          
##    Detection Prevalence : 0.6747          
##       Balanced Accuracy : 0.8363          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<p>The accuracy of the tuned model on the test set increase 0.01, not much.</p>
</div>
<div id="variable-importance-1" class="section level4">
<h4>Variable Importance</h4>
<p><img src="model_files/figure-html/var%20import-1.png" width="80%" /></p>
</div>
<div id="partial-dependece" class="section level4">
<h4>Partial Dependece</h4>
<p><img src="model_files/figure-html/partial%20depe-1.png" width="80%" /><img src="model_files/figure-html/partial%20depe-2.png" width="80%" /> To show the predictive ability of the variable, we take <em>LeadTime</em> as an example.<br />
The graph above represents the the partial dependece on <em>LeadTime</em> for Class 1 (canceled) and Class 0 (not canceled).<br />
If the lead time between booking date and entering/canceled date is greater than 100 days, the model tends to predict the booking will not be canceled.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

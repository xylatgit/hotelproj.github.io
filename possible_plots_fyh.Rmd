---
title: "possible_plots_fyh"
author: "Yihan Feng"
date: "11/15/2020"
output: html_document
---


```{r}
library(tidyverse)
library(plotly)
```

import data, and filter the year 2016 data
```{r}
hotel_df <- 
  read.csv("./data/hotel_bookings.csv") %>%
  filter(arrival_date_year == "2016") %>%
  mutate(is_canceled = as.factor(is_canceled))
```



1. Lead time and cancellation

```{r}
hotel_df %>%
  count(is_canceled, lead_time, hotel) %>%
  mutate(is_canceled = recode(is_canceled, "1" = "Canceled", "0" = "Not Canceled")) %>%
  plot_ly(
    x = ~is_canceled, y = ~lead_time,
    type = "violin", color = ~hotel, colors = "viridis"
  ) %>%
  layout(title = "Cancellation Distribution with Lead Time",
         xaxis = list(title = "cancellation"),
         yaxis = list(title = "lead time (days)"),
         violinmode = "group")
```




2. deposit type and cancellation

```{r}
hotel_df %>%
  group_by(is_canceled) %>%
  count(deposit_type) %>%
  mutate(is_canceled = recode(is_canceled, "1" = "Canceled", "0" = "Not Canceled"),
         text_label = str_c("\nTotal Counts: ", n)) %>%
  plot_ly(
    x = ~deposit_type, y = ~n, color = ~is_canceled,
    type = "bar", text = ~text_label, colors = "viridis"
  ) %>%
  layout(title = "Cancellation Distribution with Deposit Type",
         xaxis = list(title = "Deposit Type"),
         yaxis = list(title = "Count"),
         barmode = "group"
)
```




3. adult guests & cancellation
```{r}
hotel_df %>%
  count(is_canceled, adults) %>%
  mutate(is_canceled = recode(is_canceled, "1" = "Canceled", "0" = "Not Canceled"),
         text_label = str_c("Number of Adults: ", adults, "\nCounts: ", n)) %>%
  plot_ly(
    x = ~adults, y = ~n, color = ~is_canceled,
    type = "bar", text = ~text_label, colors = "viridis"
  ) %>% 
  layout(title = "Cancellation Distribution with Number of Adult Guests",
         xaxis = list(title = "Number of Adults"), 
         yaxis = list(title = "Counts"))
```


children only & cancellation

```{r}
hotel_df %>%
  select(is_canceled, adults, children) %>%
  filter(adults == 0, children > 0) %>%
  count(is_canceled, children) %>%
  mutate(
    is_canceled = recode(is_canceled, "1" = "Canceled", "0" = "Not Canceled"), 
    text_label = str_c("Number of Children: ", children, "\nTotal Counts: ", n)) %>%
  plot_ly(
    x = ~children, y = ~n, color = ~is_canceled, 
    type = "bar", text = ~text_label, colors = "viridis"
  ) %>%
  layout(title = "Cancellation Distribution with Number of Children Only", 
         xaxis = list(title = "Number of Children Only"), 
         yaxis = list(title = "Counts"))
```
there are some rows show that the number of adults, children, and babies are all 0?



4. special requests & cancellation

```{r}
hotel_df %>%
  select(is_canceled, total_of_special_requests, hotel) %>%
  count(total_of_special_requests, is_canceled) %>%
  mutate(is_canceled = recode(is_canceled, "1" = "Canceled", "0" = "Not Canceled"), 
         text_label = str_c("\nNumber of Special Requests: ", total_of_special_requests, "\nCounts: ", n)) %>%
  plot_ly(
    x = ~total_of_special_requests, y = ~n, color = ~is_canceled,
    type = "bar", text = ~text_label, colors = "viridis"
  ) %>%
  layout(
    title = "Cancellation Distribution with Number of Special Requests", 
    xaxis = list(title = "Total Number of Special Requests"), 
    yaxis = list(title = "Counts")
  )

```





























